resources:
  - ../../../../kustomize/bases/base
namePrefix: next-city-gallery-
commonLabels:
  app: next-city-gallery

# Apply ConfigMap
patches:
  - target:
      name: app
      kind: Deployment
    patch: |-
      - op: add
        path: /spec/template/spec/containers/0/envFrom
        value:
        - configMapRef:
            name: next-city-gallery

  - target:
      name: ingress
      kind: Ingress
    patch: |-
      - op: replace
        path: /spec/rules/0/host
        value: $URL_NEXT_CITY_GALLERY
      - op: replace
        path: /spec/tls/0/hosts/0
        value: $URL_NEXT_CITY_GALLERY

# Rename Images
images:
  - name: node
    newName: $REPOSITORY/next-city-gallery
    newTag: $TAG
